import{u as S,a as U,_ as $,b as E,c as O}from"./useFilterRows-Dkj22RlA.js";import{r as i,a as f,c as g,b as P,d as w,o as j}from"./index-7h-RjzT1.js";const q={class:"container"},x="/api/orders",V={__name:"Orders",setup(B){const u=S(),_=u.getHostUrl,b=u.getKey,r=i({}),c=f(!1);let n=i([]);const a=i({isLoading:!1,columns:[],rows:[],totalRecordCount:0}),l=f(10),{getDateWithOffset:d}=U(),v=g(()=>d()),D=g(()=>d(-7)),h=async e=>{a.isLoading=!0,c.value=!1;let s=0;e&&e/l.value>=1&&(s=Math.ceil((e+1)/l.value));try{const o=new URLSearchParams({dateFrom:D.value,dateTo:v.value,page:s,key:b,limit:l.value}),m=await fetch(`${_}${x}?${o.toString()}`);if(!m.ok)throw new Error("Failed to fetch data");const p=await m.json();n=p.data,a.rows=n,a.totalRecordCount=p.meta.total;const C=[...new Set(Object.keys(a.rows[0]))];a.columns=C.map(t=>({label:L(t),field:t,width:"3.5%",sortable:!1}));const F=a.rows.map(t=>t.barcode),R=a.rows.map(t=>t.price);r.labels=F,r.datasets=[{label:"Price",backgroundColor:"#f87979",data:R}],c.value=!0}catch(o){console.error("Error fetching",o)}};function L(e){return e.replace(/_([a-z])/gi,function(s,o){return o.toUpperCase()})}h(0);const k=()=>{a.isLoading=!1},y=e=>{a.isLoading=!0,a.rows=O(n,e.value,["warehouse_name","supplier_article"]),a.isLoading=!1};return(e,s)=>(j(),P("div",q,[w($,{table:a,onLoadingFinish:k,onDoSearch:h,onFilterRows:y},null,8,["table"]),w(E,{class:"chart",loaded:c.value,chartData:r},null,8,["loaded","chartData"])]))}};export{V as default};
