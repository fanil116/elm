import{u as C,a as F,_ as R,b as U,c as $}from"./useFilterRows-CdM_lKSH.js";import{r as i,a as p,c as E,b as P,d as g,o as j}from"./index-B8heQ7-U.js";const q={class:"container"},x="/api/stocks",T={__name:"Stocks",setup(B){const u=C(),w=u.getHostUrl,_=u.getKey,r=i({}),c=p(!1);let n=i([]);const a=i({isLoading:!1,columns:[],rows:[],totalRecordCount:0}),l=p(10),{getDateWithOffset:b}=F(),d=E(()=>b()),h=async e=>{a.isLoading=!0,c.value=!1;let s=0;e&&e/l.value>=1&&(s=Math.ceil((e+1)/l.value));try{const o=new URLSearchParams({dateFrom:d.value,dateTo:d.value,page:s,key:_,limit:l.value}),m=await fetch(`${w}${x}?${o.toString()}`);if(!m.ok)throw new Error("Failed to fetch data");const f=await m.json();n=f.data,a.rows=n,a.totalRecordCount=f.meta.total;const D=[...new Set(Object.keys(a.rows[0]))];a.columns=D.map(t=>({label:v(t),field:t,width:"3.5%",sortable:!1}));const S=a.rows.map(t=>t.barcode),y=a.rows.map(t=>t.price);r.labels=S,r.datasets=[{label:"Price",backgroundColor:"#f87979",data:y}],c.value=!0}catch(o){console.error("Error fetching",o)}};function v(e){return e.replace(/_([a-z])/gi,function(s,o){return o.toUpperCase()})}h(0);const k=()=>{a.isLoading=!1},L=e=>{a.isLoading=!0,a.rows=$(n,e.value,["warehouse_name","supplier_article"]),a.isLoading=!1};return(e,s)=>(j(),P("div",q,[g(R,{table:a,onLoadingFinish:k,onDoSearch:h,onFilterRows:L},null,8,["table"]),g(U,{class:"chart",loaded:c.value,chartData:r},null,8,["loaded","chartData"])]))}};export{T as default};
